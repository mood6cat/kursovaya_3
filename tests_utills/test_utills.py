from utills.utills import load_loaded_files, filter_data, sort_data, format_data


def test_load_loaded_file():
    data = load_loaded_files()
    assert type(data) is list


def test_filter_data(item_from_conf):
    assert filter_data(item_from_conf) == [{
        "id": 587085106,
        "state": "EXECUTED",
        "date": "2018-03-23T10:45:06.972075",
        "operationAmount": {
            "amount": "48223.05",
            "currency": {
                "name": "руб.",
                "code": "RUB"
            }
        },
        "description": "Открытие вклада",
        "to": "Счет 41421565395219882431"
    }]


def test_sort_data(sort_from_conf):
    assert sort_data(sort_from_conf) == [{'id': 863064926, 'state': 'EXECUTED', 'date': '2019-12-08T22:46:21.935582',
                                          'operationAmount': {'amount': '41096.24',
                                                              'currency': {'name': 'USD', 'code': 'USD'}},
                                          'description': 'Открытие вклада', 'to': 'Счет 90424923579946435907'},
                                         {'id': 114832369, 'state': 'EXECUTED', 'date': '2019-12-07T06:17:14.634890',
                                          'operationAmount': {'amount': '48150.39',
                                                              'currency': {'name': 'USD', 'code': 'USD'}},
                                          'description': 'Перевод организации', 'from': 'Visa Classic 2842878893689012',
                                          'to': 'Счет 35158586384610753655'},
                                         {'id': 154927927, 'state': 'EXECUTED', 'date': '2019-11-19T09:22:25.899614',
                                          'operationAmount': {'amount': '30153.72',
                                                              'currency': {'name': 'руб.', 'code': 'RUB'}},
                                          'description': 'Перевод организации', 'from': 'Maestro 7810846596785568',
                                          'to': 'Счет 43241152692663622869'},
                                         {'id': 482520625, 'state': 'EXECUTED', 'date': '2019-11-13T17:38:04.800051',
                                          'operationAmount': {'amount': '62814.53',
                                                              'currency': {'name': 'руб.', 'code': 'RUB'}},
                                          'description': 'Перевод со счета на счет',
                                          'from': 'Счет 38611439522855669794', 'to': 'Счет 46765464282437878125'},
                                         {'id': 801684332, 'state': 'EXECUTED', 'date': '2019-11-05T12:04:13.781725',
                                          'operationAmount': {'amount': '21344.35',
                                                              'currency': {'name': 'руб.', 'code': 'RUB'}},
                                          'description': 'Открытие вклада', 'to': 'Счет 77613226829885488381'}]


def test_format_dat(format_data_from_conf):
    assert format_data(format_data_from_conf) == ['  \n26.08.19 Перевод организации \nMaestro 1596 83** **** 5199 --> Счет ** 9589\n31957.58 руб.\n                    ', '  \n03.07.19 Перевод организации \nMasterCard 7158 30** **** 6758 --> Счет ** 5560\n8221.37 USD\n                    ', '  \n30.06.18 Перевод организации \nСчет 7510 68** **** 6952 --> Счет ** 6702\n9824.07 USD\n                    ', '\n23.03.18 Открытие вклада \nНовый счёт:  Счет ** 2431\n48223.05 руб.\n        ', '  \n04.04.19 Перевод со счета на счет \nСчет 1970 86** **** 8542 --> Счет ** 4188\n79114.93 USD\n                    ', '  \n23.03.19 Перевод со счета на счет \nСчет 4481 22** **** 4719 --> Счет ** 1160\n43318.34 руб.\n                    ', '  \n20.12.18 Перевод организации \nСчет 1084 83** **** 5355 --> Счет ** 6366\n70946.18 USD\n                    ', '  \n12.07.19 Перевод организации \nСчет 4889 44** **** 4368 --> Счет ** 8358\n51463.70 USD\n                    ', '  \n19.08.18 Перевод с карты на карту \nVisa Classic 6831 98** **** 7658 --> Visa Platinum ** 5229\n56883.54 USD\n                    ', '\n11.07.18 Открытие вклада \nНовый счёт:  Счет ** 6215\n79931.03 руб.\n        ', '  \n04.04.18 Перевод организации \nVisa Gold 5999 41** **** 6353 --> Счет ** 4472\n40701.91 USD\n                    ', '\n08.12.19 Открытие вклада \nНовый счёт:  Счет ** 5907\n41096.24 USD\n        ', '  \n12.09.18 Перевод организации \nVisa Platinum 1246 37** **** 3588 --> Счет ** 1657\n67314.70 руб.\n                    ', '  \n14.10.18 Перевод с карты на счет \nMaestro 3928 54** **** 4026 --> Счет ** 3493\n77751.04 руб.\n                    ', '  \n26.01.18 Перевод с карты на счет \nMaestro 4598 30** **** 4501 --> Счет ** 5086\n50870.71 руб.\n                    ', '  \n29.11.18 Перевод с карты на карту \nMasterCard 3152 47** **** 5065 --> Visa Gold ** 5960\n3348.98 USD\n                    ', '  \n14.04.18 Перевод организации \nСчет 2724 85** **** 8655 --> Счет ** 8967\n96995.73 руб.\n                    ', '  \n11.09.19 Перевод организации \nСчет 2476 33** **** 4080 --> Счет ** 6930\n54280.01 USD\n                    ', '  \n14.10.18 Перевод организации \nVisa Platinum 2256 48** **** 2539 --> Счет ** 9319\n90582.51 USD\n                    ', '  \n12.04.19 Перевод со счета на счет \nСчет 7365 41** **** 4305 --> Счет ** 2412\n43861.89 USD\n                    ', '  \n03.02.18 Перевод с карты на карту \nMasterCard 4047 67** **** 3225 --> Maestro ** 3662\n67011.26 руб.\n                    ', '  \n02.03.18 Перевод организации \nСчет 9600 89** **** 1147 --> Счет ** 3001\n7484.91 USD\n                    ', '  \n12.06.18 Перевод организации \nVisa Classic 4195 19** **** 3802 --> Счет ** 2883\n26334.08 USD\n                    ', '\n28.12.18 Открытие вклада \nНовый счёт:  Счет ** 2391\n49192.52 USD\n        ', '  \n23.11.18 Перевод с карты на карту \nVisa Gold 7305 79** **** 4042 --> Maestro ** 7194\n26971.25 руб.\n                    ', '  \n12.07.19 Перевод организации \nVisa Gold 3589 27** **** 1603 --> Счет ** 3355\n2631.44 руб.\n                    ', '  \n22.02.18 Перевод организации \nMasterCard 4956 64** **** 7418 --> Счет ** 2248\n71771.90 USD\n                    ', '  \n29.09.19 Перевод со счета на счет \nСчет 3542 14** **** 9637 --> Счет ** 4961\n45849.53 USD\n                    ', '  \n21.01.18 Перевод со счета на счет \nСчет 3340 72** **** 7865 --> Счет ** 1215\n96900.90 руб.\n                    ', '  \n23.11.18 Перевод с карты на карту \nVisa Platinum 5355 13** **** 8236 --> Maestro ** 9061\n79428.73 USD\n                    ', '  \n15.01.19 Перевод организации \nVisa Platinum 2241 65** **** 8487 --> Счет ** 8486\n90688.44 USD\n                    ', '  \n01.06.19 Перевод с карты на счет \nМИР 8201 42** **** 6664 --> Счет ** 9956\n60888.63 руб.\n                    ', '  \n31.07.18 Перевод организации \nMasterCard 8532 49** **** 2395 --> Счет ** 9420\n34380.08 USD\n                    ', '  \n08.10.18 Перевод с карты на счет \nVisa Gold 6527 18** **** 7720 --> Счет ** 9611\n77302.31 USD\n                    ', '  \n11.04.19 Перевод с карты на карту \nМИР 8193 81** **** 8899 --> МИР ** 4146\n62621.51 руб.\n                    ', '  \n29.12.18 Перевод организации \nСчет 7797 75** **** 1529 --> Счет ** 1891\n66263.93 руб.\n                    ', '  \n14.06.19 Перевод со счета на счет \nСчет 7322 27** **** 5679 --> Счет ** 8747\n63150.74 USD\n                    ', '  \n30.10.19 Перевод с карты на счет \nVisa Gold 7756 67** **** 2839 --> Счет ** 9453\n23036.03 руб.\n                    ', '\n05.11.19 Открытие вклада \nНовый счёт:  Счет ** 8381\n21344.35 руб.\n        ', '  \n08.08.19 Перевод организации \nСчет 9966 86** **** 9694 --> Счет ** 8245\n98657.83 руб.\n                    ', '  \n19.11.19 Перевод организации \nMaestro 7810 84** **** 5568 --> Счет ** 2869\n30153.72 руб.\n                    ', '  \n04.06.18 Перевод организации \nСчет 5488 39** **** 2073 --> Счет ** 9145\n978.31 USD\n                    ', '  \n15.10.18 Перевод с карты на карту \nMasterCard 1435 44** **** 8409 --> Maestro ** 9235\n51203.12 USD\n                    ', '  \n14.02.19 Перевод организации \nVisa Classic 6216 53** **** 9975 --> Счет ** 9708\n47022.09 руб.\n                    ', '  \n09.03.18 Перевод с карты на счет \nVisa Classic 7022 98** **** 6865 --> Счет ** 3410\n33249.01 руб.\n                    ', '  \n08.11.18 Перевод организации \nСчет 7574 37** **** 8755 --> Счет ** 1744\n16872.46 USD\n                    ', '  \n15.08.19 Перевод организации \nСчет 6529 89** **** 7907 --> Счет ** 9418\n31222.43 руб.\n                    ', '  \n23.01.18 Перевод с карты на карту \nVisa Classic 3414 39** **** 3483 --> Visa Gold ** 7419\n2974.30 USD\n                    ', '  \n13.01.18 Перевод с карты на карту \nVisa Classic 8906 17** **** 3215 --> Visa Platinum ** 8217\n55985.82 USD\n                    ', '  \n18.12.18 Перевод со счета на счет \nСчет 8667 56** **** 1969 --> Счет ** 7994\n19683.25 USD\n                    ', '  \n08.07.19 Перевод со счета на счет \nСчет 3842 75** **** 7521 --> Счет ** 9323\n10083.68 USD\n                    ', '  \n06.02.18 Перевод организации \nMasterCard 9175 98** **** 9563 --> Счет ** 7668\n621.37 руб.\n                    ', '\n21.06.19 Открытие вклада \nНовый счёт:  Счет ** 6762\n25762.92 руб.\n        ', '  \n03.03.19 Перевод с карты на счет \nVisa Classic 6319 35** **** 9800 --> Счет ** 7791\n44493.45 USD\n                    ', '  \n25.08.18 Перевод с карты на карту \nVisa Classic 4040 55** **** 7672 --> Visa Platinum ** 8021\n52245.30 USD\n                    ', '  \n15.07.18 Перевод с карты на счет \nVisa Gold 9657 49** **** 2945 --> Счет ** 4261\n71024.64 руб.\n                    ', '  \n03.12.19 Перевод с карты на карту \nMasterCard 1796 81** **** 9527 --> Visa Classic ** 9288\n17628.50 USD\n                    ', '  \n04.08.19 Перевод со счета на счет \nСчет 3372 15** **** 3763 --> Счет ** 2778\n2523.44 руб.\n                    ', '  \n07.09.19 Перевод с карты на карту \nMaestro 4284 34** **** 4246 --> МИР ** 7301\n18536.73 руб.\n                    ', '\n06.08.18 Открытие вклада \nНовый счёт:  Счет ** 5758\n82946.19 руб.\n        ', '  \n07.05.19 Перевод с карты на карту \nМИР 4878 65** **** 3856 --> Maestro ** 9619\n29033.65 USD\n                    ', '  \n17.05.19 Перевод с карты на карту \nМИР 8021 88** **** 6544 --> Visa Gold ** 3248\n74604.56 USD\n                    ', '  \n08.02.19 Перевод организации \nСчет 2842 94** **** 9335 --> Счет ** 5633\n62654.30 USD\n                    ', '  \n16.06.19 Перевод с карты на счет \nVisa Platinum 8990 85** **** 4895 --> Счет ** 4010\n24260.78 USD\n                    ', '  \n04.05.18 Перевод с карты на счет \nMasterCard 3595 83** **** 7400 --> Счет ** 5210\n22007.02 USD\n                    ', '  \n29.03.19 Перевод с карты на счет \nVisa Classic 1203 92** **** 4079 --> Счет ** 2721\n30234.99 USD\n                    ', '  \n14.08.18 Перевод со счета на счет \nСчет 1812 57** **** 1166 --> Счет ** 2372\n19010.50 руб.\n                    ', '  \n14.02.19 Перевод организации \nVisa Classic 4610 24** **** 6784 --> Счет ** 2700\n37044.95 руб.\n                    ', '  \n05.05.18 Перевод с карты на счет \nMasterCard 9454 78** **** 4532 --> Счет ** 1351\n56071.02 руб.\n                    ', '  \n23.12.18 Перевод с карты на карту \nМИР 8665 24** **** 6074 --> Maestro ** 4087\n47408.20 USD\n                    ', '  \n07.12.19 Перевод организации \nVisa Classic 2842 87** **** 9012 --> Счет ** 3655\n48150.39 USD\n                    ', '\n18.04.19 Открытие вклада \nНовый счёт:  Счет ** 4865\n73778.48 руб.\n        ', '  \n13.11.19 Перевод со счета на счет \nСчет 3861 14** **** 9794 --> Счет ** 8125\n62814.53 руб.\n                    ', '  \n30.06.19 Перевод со счета на счет \nСчет 5995 68** **** 5975 --> Счет ** 5820\n95860.47 руб.\n                    ', '  \n19.04.19 Перевод с карты на карту \nMaestro 9171 98** **** 9925 --> МИР ** 4182\n81513.74 руб.\n                    ', '  \n16.04.18 Перевод организации \nVisa Platinum 1813 16** **** 6336 --> Счет ** 9635\n65169.27 USD\n                    ', '  \n13.02.18 Перевод организации \nСчет 3335 50** **** 2963 --> Счет ** 8682\n42210.20 руб.\n                    ', '  \n22.07.18 Перевод организации \nСчет 1962 88** **** 4147 --> Счет ** 7473\n92130.50 USD\n                    ', '\n03.02.18 Открытие вклада \nНовый счёт:  Счет ** 8767\n90297.21 руб.\n        ', '  \n17.08.18 Перевод организации \nMaestro 1913 88** **** 1351 --> Счет ** 2427\n66906.45 USD\n                    ', '  \n12.02.19 Перевод организации \nСчет 7264 51** **** 2984 --> Счет ** 4115\n16796.95 USD\n                    ', '  \n22.04.18 Перевод организации \nVisa Platinum 3530 19** **** 7121 --> Счет ** 7528\n84732.61 руб.\n                    ', '  \n16.08.19 Перевод с карты на счет \nMasterCard 8826 23** **** 2405 --> Счет ** 9721\n6004.00 руб.\n                    ', '  \n06.07.18 Перевод с карты на карту \nVisa Classic 4062 74** **** 4804 --> Maestro ** 1155\n37160.27 руб.\n                    ', '  \n27.09.18 Перевод организации \nСчет 2317 78** **** 5559 --> Счет ** 3778\n45653.70 руб.\n                    ', '  \n06.05.19 Перевод со счета на счет \nСчет 2792 13** **** 7520 --> Счет ** 4470\n74895.83 руб.\n                    ', '  \n27.02.19 Перевод с карты на счет \nMasterCard 8847 38** **** 3026 --> Счет ** 3377\n69311.35 руб.\n                    ', '  \n18.07.19 Перевод с карты на карту \nVisa Platinum 6942 69** **** 7688 --> МИР ** 3342\n82139.20 руб.\n                    ', '  \n08.06.18 Перевод организации \nMaestro 7552 74** **** 9311 --> Счет ** 6850\n91121.62 руб.\n                    ', '  \n24.06.18 Перевод организации \nМИР 6381 70** **** 9111 --> Счет ** 6026\n60030.73 USD\n                    ', '  \n06.09.19 Перевод организации \nVisa Gold 3654 41** **** 1162 --> Счет ** 8289\n6357.56 USD\n                    ', '  \n20.06.18 Перевод с карты на счет \nМИР 3766 44** **** 8784 --> Счет ** 3980\n96350.51 USD\n                    ', '  \n19.08.19 Перевод организации \nСчет 1769 13** **** 4901 --> Счет ** 7621\n81150.87 USD\n                    ', '  \n22.12.18 Перевод с карты на карту \nVisa Gold 8326 53** **** 6459 --> MasterCard ** 1847\n56516.63 USD\n                    ', '  \n19.05.19 Перевод организации \nМИР 5211 27** **** 8469 --> Счет ** 2662\n6381.58 USD\n                    ', '  \n24.12.18 Перевод со счета на счет \nСчет 7168 74** **** 5290 --> Счет ** 9781\n991.49 руб.\n                    ', '  \n09.03.18 Перевод организации \nСчет 2640 62** **** 3262 --> Счет ** 1315\n25780.71 руб.\n                    ', '\n15.07.19 Открытие вклада \nНовый счёт:  Счет ** 2265\n92688.46 USD\n        ', '  \n05.01.19 Перевод со счета на счет \nСчет 4636 36** **** 8409 --> Счет ** 8266\n87941.37 руб.\n                    ', '  \n13.07.19 Перевод с карты на счет \nMaestro 1308 79** **** 7170 --> Счет ** 8612\n97853.86 руб.\n                    ']















